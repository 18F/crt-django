{% extends "forms/base.html" %}

{% block page_header %}
<header class="page-header-background">
  <div class="grid-container">
    <div class="grid-row">
      <div class="grid-col-12">
        <p align="right"><a href="/accounts/logout">log out</a></p>
        <h1>
          CRT Complaint Records
        </h1>
      </div>
    </div>
  </div>
</header>
{% endblock %}

{% block main_class %} class="page-header-background"{% endblock %}


{% block content %}
<div class="grid-container">
  <div class="grid-col-auto">
    <a href="/report">
      <button name="Create record" label="first step" class="usa-button margin-top-2">
        + Add new record
      </button>
    </a>
    <table class="usa-table crt-table">
      <thead>
        <tr>
          <th scope="col">Submitted</th>
          <th scope="col">Contact Name</th>
          <th scope="col">Contact Details</th>
          <th scope="col">Violation Summary</th>
          <th scope="col">Class</th>
        </tr>
      </thead>
      {% if data_dict %}
        {% for violationreport in data_dict %}
          <tr>
            <td scope="row">{{ violationreport.0.create_date|date:"SHORT_DATE_FORMAT" }}</td>
            <td>
            {% with last=violationreport.0.contact_last_name|default:"—" %}
                {{ last|truncatechars:20 }}{% endwith %}, {% with first=violationreport.0.contact_first_name|default:"—" %}
                {{ first|truncatechars:20 }}
            {% endwith %}
            </td>
            <td>
            {% with email=violationreport.0.contact_email|default:"—" %}
                {{ email|truncatechars:20 }}
            {% endwith %}
            <br>
            {% with phone=violationreport.0.contact_phone|default:"—"  %}
                {{ phone|truncatechars:20 }}
            {% endwith %}
            </td>
            <td>
            {% with summary=violationreport.0.violation_summary|default:"—" %}
                {{ summary|truncatechars:120 }}
            {% endwith %}
            </td>
            <td>
            {% with protected_class=violationreport.1|default:"—" %}
                {{ protected_class|truncatechars:50 }}
            {% endwith %}
            </td>
          </tr>
        {% endfor %}
      {% else %}
        <tr><td>No reports are available.<td><td></td><td></td><tr>
      {% endif %}
    </table>
  </div>
</div>
{% endblock %}
